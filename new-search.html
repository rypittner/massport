<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Google Places Text Search</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 1em; }
    #results { margin-top: 1em; }
    .place { cursor: pointer; padding: 5px; border-bottom: 1px solid #ccc; }
    .place:hover { background: #efefef; }
  </style>
</head>
<body>
  <h1>Place Search</h1>
  <input type="text" id="search" placeholder="Type a place name..." />
  <button id="searchBtn">Search</button>

  <div id="results"></div>

  <script>
    const searchInput = document.getElementById('search');
    const searchBtn = document.getElementById('searchBtn');
    const resultsDiv = document.getElementById('results');

    searchBtn.addEventListener('click', async () => {
      const query = searchInput.value.trim();
      if (!query) {
        alert('Please enter a search query.');
        return;
      }

      resultsDiv.innerHTML = 'Searching...';

      try {
        const res = await fetch('/places/textsearch', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ query }),
        });

        if (!res.ok) throw new Error('Network error');

        const data = await res.json();

        if (!data.results || data.results.length === 0) {
          resultsDiv.innerHTML = 'No results found.';
          return;
        }

        resultsDiv.innerHTML = '';
        data.results.forEach(place => {
          const div = document.createElement('div');
          div.className = 'place';
          div.textContent = place.name + ' â€” ' + (place.formatted_address || place.vicinity || '');
          div.addEventListener('click', () => {
            alert(`You clicked: ${place.name}\nAddress: ${place.formatted_address || place.vicinity || 'N/A'}`);
          });
          resultsDiv.appendChild(div);
        });

      } catch (error) {
        resultsDiv.innerHTML = 'Error: ' + error.message;
      }
    });
  </script>
</body>
</html>

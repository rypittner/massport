<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Google Places Text Search Example</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
    }
    #searchResults {
      border: 1px solid #ccc;
      max-width: 600px;
      margin-top: 0.5rem;
      padding: 0;
      list-style: none;
      max-height: 300px;
      overflow-y: auto;
    }
    #searchResults li {
      padding: 8px 12px;
      cursor: pointer;
      border-bottom: 1px solid #eee;
    }
    #searchResults li:hover {
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>
  <h1>Google Places Text Search</h1>
  <input
    id="searchInput"
    type="text"
    placeholder="Enter place to search"
    style="width: 600px; padding: 8px; font-size: 16px;"
  />
  <ul id="searchResults"></ul>

  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCmOEfuSho8iQNLWykqxkjvg-I2A1yxFK0&libraries=places"
    async
    defer
  ></script>
  <script>
    let placesService;
    let map; // dummy map because PlacesService requires a map or div container

    function init() {
      // Create a dummy div for PlacesService (it needs a div or map instance)
      const dummyDiv = document.createElement('div');
      map = new google.maps.Map(dummyDiv);

      placesService = new google.maps.places.PlacesService(map);

      const input = document.getElementById('searchInput');
      const resultsList = document.getElementById('searchResults');

      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          performSearch(input.value);
        }
      });

      function performSearch(query) {
        if (!query.trim()) {
          resultsList.innerHTML = '';
          return;
        }

        const request = {
          query: query,
          fields: ['name', 'formatted_address', 'place_id'],
        };

        placesService.textSearch(request, (results, status) => {
          if (status === google.maps.places.PlacesServiceStatus.OK && results) {
            resultsList.innerHTML = '';

            results.forEach((place) => {
              const li = document.createElement('li');
              li.textContent = place.name + ' â€” ' + place.formatted_address;
              li.dataset.placeId = place.place_id;

              li.addEventListener('click', () => {
                input.value = place.name;
                resultsList.innerHTML = '';
                getPlaceDetails(place.place_id);
              });

              resultsList.appendChild(li);
            });
          } else {
            resultsList.innerHTML = '<li>No results found</li>';
          }
        });
      }

      function getPlaceDetails(placeId) {
        const request = {
          placeId: placeId,
          fields: ['name', 'formatted_address', 'formatted_phone_number', 'website', 'opening_hours'],
        };

        placesService.getDetails(request, (place, status) => {
          if (status === google.maps.places.PlacesServiceStatus.OK && place) {
            console.log('Place details:', place);
            alert(`Details for ${place.name}:\nAddress: ${place.formatted_address}\nPhone: ${place.formatted_phone_number || 'N/A'}\nWebsite: ${place.website || 'N/A'}`);
          } else {
            alert('Failed to get place details.');
          }
        });
      }
    }

    // Initialize when Google Maps JS loads
    window.initMap = init;
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Places Search (New API)</title>
  <style>
    #results { margin-top: 1em; }
    .place { cursor: pointer; padding: 5px; border-bottom: 1px solid #ddd; }
    .place:hover { background-color: #eef; }
  </style>
</head>
<body>
  <h1>Place Search (New Places API)</h1>
  <input id="search" type="text" placeholder="Search places..." autocomplete="off" />
  <div id="results"></div>

  <script>
    let map; // dummy map required for PlacesService
    let service;

    function initMap() {
      // Dummy map just to initialize PlacesService
      map = new google.maps.Map(document.createElement('div'));
      service = new google.maps.places.PlacesService(map);

      const input = document.getElementById('search');
      const resultsDiv = document.getElementById('results');

      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          const query = input.value.trim();
          if (!query) {
            resultsDiv.innerHTML = '';
            return;
          }
          resultsDiv.innerHTML = 'Searching...';

          const request = {
            query: query,
            fields: ['name', 'formatted_address', 'place_id'],
          };

          service.findPlaceFromQuery(request, (results, status) => {
            if (status !== google.maps.places.PlacesServiceStatus.OK || !results) {
              resultsDiv.innerHTML = 'No results found or error: ' + status;
              return;
            }
            resultsDiv.innerHTML = '';
            results.forEach(place => {
              const div = document.createElement('div');
              div.className = 'place';
              div.textContent = `${place.name} â€” ${place.formatted_address}`;
              div.addEventListener('click', () => {
                alert(`You selected:\n${place.name}\nPlace ID: ${place.place_id}`);
              });
              resultsDiv.appendChild(div);
            });
          });
        }
      });
    }
  </script>

  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCmOEfuSho8iQNLWykqxkjvg-I2A1yxFK0&libraries=places&callback=initMap"
    async
    defer
  ></script>
</body>
</html>
